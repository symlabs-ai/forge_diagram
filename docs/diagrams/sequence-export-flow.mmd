%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#ea580c', 'primaryTextColor': '#fff', 'primaryBorderColor': '#c2410c', 'lineColor': '#f97316'}}}%%
sequenceDiagram
    autonumber
    participant U as Usuario
    participant SD as ShareDialog
    participant UE as useExport
    participant EU as exportUtils
    participant SU as shareUtils
    participant C as Canvas
    participant CB as Clipboard
    participant B as Browser

    Note over U,B: Exportar como PNG

    U->>SD: Click "PNG"
    SD->>UE: exportPng()
    UE->>EU: svgToPng(svgElement)
    EU->>C: drawImage(svg)
    C->>C: toBlob()
    C-->>EU: Blob
    EU->>EU: downloadBlob()
    EU->>B: Create <a> download
    B-->>U: File downloaded

    Note over U,B: Copiar URL Compartilhavel

    U->>SD: Click "URL"
    SD->>SU: generateShareUrl(code)
    SU->>SU: pako.gzip(code)
    SU->>SU: base64 encode
    SU-->>SD: URL with hash
    SD->>CB: navigator.clipboard.writeText()
    CB-->>U: "Link copiado!"

    Note over U,B: Exportar SVG

    U->>SD: Click "SVG"
    SD->>UE: exportSvg()
    UE->>EU: getSvgString()
    EU->>EU: new Blob([svg])
    EU->>B: downloadBlob()
    B-->>U: .svg file

    Note over U,B: Copiar SVG

    U->>SD: Click "Copy SVG"
    SD->>UE: copySvg()
    UE->>CB: navigator.clipboard.writeText(svg)
    CB-->>U: "SVG copiado!"
